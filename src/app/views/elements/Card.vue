<template>

  <div class="card" :class="classes" :data-id="item.id">
    <div class="icons">
      <span v-if="isDue" class="icon icon-due has-text-warning" :title="`Item is due on ${item.date}`">
        <i class="fas fa-star"></i>
      </span>
      <span v-else-if="timestamp" class="icon icon-date" :title="`Item is due on ${item.date}`">
        <i class="far fa-bell"></i>
      </span>
      <span class="icon icon-edit" @click="edit">
        <svg width="219" height="225" viewBox="0 0 219 225" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M171.787 221.599H25.621C13.213 221.599 3.12097 211.507 3.12097 199.099V52.93C3.12097 40.522 13.213 30.43 25.621 30.43H115.501V39.43H25.621C18.178 39.43 12.121 45.487 12.121 52.93V199.099C12.121 206.542 18.178 212.599 25.621 212.599H171.79C179.233 212.599 185.29 206.542 185.29 199.099V90.406H194.29V199.099C194.287 211.504 184.195 221.599 171.787 221.599Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M117.501 28.43V41.43H25.621C19.2825 41.43 14.121 46.5916 14.121 52.93V199.099C14.121 205.437 19.2825 210.599 25.621 210.599H171.79C178.128 210.599 183.29 205.437 183.29 199.099V88.406H196.29V199.099C196.287 212.608 185.3 223.599 171.787 223.599H25.621C12.1084 223.599 1.12097 212.612 1.12097 199.099V52.93C1.12097 39.4174 12.1084 28.43 25.621 28.43H117.501ZM194.29 199.099C194.287 211.504 184.195 221.599 171.787 221.599H25.621C13.213 221.599 3.12097 211.507 3.12097 199.099V52.93C3.12097 40.522 13.213 30.43 25.621 30.43H115.501V39.43H25.621C18.178 39.43 12.121 45.487 12.121 52.93V199.099C12.121 206.542 18.178 212.599 25.621 212.599H171.79C179.233 212.599 185.29 206.542 185.29 199.099V90.406H194.29V199.099Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M116.501 29.43V40.43H25.621C18.7303 40.43 13.121 46.0393 13.121 52.93V199.099C13.121 205.99 18.7303 211.599 25.621 211.599H171.79C178.681 211.599 184.29 205.99 184.29 199.099V89.406H195.29V199.099C195.287 212.056 184.747 222.599 171.787 222.599H25.621C12.6607 222.599 2.12097 212.059 2.12097 199.099V52.93C2.12097 39.9697 12.6607 29.43 25.621 29.43H116.501ZM25.621 221.599H171.787C184.195 221.599 194.287 211.504 194.29 199.099V90.406H185.29V199.099C185.29 206.542 179.233 212.599 171.79 212.599H25.621C18.178 212.599 12.121 206.542 12.121 199.099V52.93C12.121 45.487 18.178 39.43 25.621 39.43H115.501V30.43H25.621C13.213 30.43 3.12097 40.522 3.12097 52.93V199.099C3.12097 211.507 13.213 221.599 25.621 221.599Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M118.501 27.43V42.43H25.621C19.8348 42.43 15.121 47.1438 15.121 52.93V199.099C15.121 204.885 19.8348 209.599 25.621 209.599H171.79C177.576 209.599 182.29 204.885 182.29 199.099V87.406H197.29V199.099C197.287 213.16 185.852 224.599 171.787 224.599H25.621C11.5561 224.599 0.120972 213.164 0.120972 199.099V52.93C0.120972 38.8651 11.5561 27.43 25.621 27.43H118.501ZM113.501 37.43H25.621C17.0734 37.43 10.121 44.3824 10.121 52.93V199.099C10.121 207.647 17.0734 214.599 25.621 214.599H171.79C180.338 214.599 187.29 207.647 187.29 199.099V92.406H192.29V199.099C192.29 199.098 192.29 199.099 192.29 199.099C192.287 210.399 183.09 219.599 171.787 219.599H25.621C14.3175 219.599 5.12097 210.402 5.12097 199.099V52.93C5.12097 41.6266 14.3175 32.43 25.621 32.43H113.501V37.43ZM25.621 39.43C18.178 39.43 12.121 45.487 12.121 52.93V199.099C12.121 206.542 18.178 212.599 25.621 212.599H171.79C179.233 212.599 185.29 206.542 185.29 199.099V90.406H194.29V199.099C194.287 211.504 184.195 221.599 171.787 221.599H25.621C13.213 221.599 3.12097 211.507 3.12097 199.099V52.93C3.12097 40.522 13.213 30.43 25.621 30.43H115.501V39.43H25.621ZM116.501 40.43H25.621C18.7303 40.43 13.121 46.0393 13.121 52.93V199.099C13.121 205.99 18.7303 211.599 25.621 211.599H171.79C178.681 211.599 184.29 205.99 184.29 199.099V89.406H195.29V199.099C195.29 199.099 195.29 199.099 195.29 199.099C195.287 212.056 184.747 222.599 171.787 222.599H25.621C12.6607 222.599 2.12097 212.059 2.12097 199.099V52.93C2.12097 39.9697 12.6607 29.43 25.621 29.43H116.501V40.43Z" fill="#707070"/>
          <path d="M56.437 167.101C55.264 167.101 54.112 166.642 53.254 165.784C52.042 164.572 51.622 162.775 52.177 161.152L70.783 106.585C71.005 105.934 71.374 105.34 71.86 104.854L169.039 7.67499C172.438 4.27599 176.956 2.40399 181.762 2.40399C186.568 2.40399 191.086 4.27599 194.485 7.67499L211.363 24.553C218.377 31.567 218.377 42.982 211.363 49.996L114.184 147.178C113.698 147.664 113.107 148.033 112.453 148.255L57.886 166.861C57.412 167.023 56.923 167.101 56.437 167.101ZM78.964 110.476L63.652 155.386L108.562 140.074L205 43.633C208.504 40.126 208.504 34.423 205 30.916L188.122 14.038C184.723 10.642 178.804 10.642 175.405 14.038L78.964 110.476Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M70.783 106.585C71.005 105.934 71.374 105.34 71.86 104.854L169.039 7.67499C172.438 4.27599 176.956 2.40399 181.762 2.40399C186.568 2.40399 191.086 4.27599 194.485 7.67499L211.363 24.553C218.377 31.567 218.377 42.982 211.363 49.996L114.184 147.178C113.698 147.664 113.107 148.033 112.453 148.255L57.886 166.861C57.412 167.023 56.923 167.101 56.437 167.101C55.264 167.101 54.112 166.642 53.254 165.784C52.042 164.572 51.622 162.775 52.177 161.152L70.783 106.585ZM50.2846 160.505L50.284 160.507C49.4821 162.854 50.0904 165.449 51.8398 167.198C53.0807 168.439 54.7448 169.101 56.437 169.101C57.1374 169.101 57.8454 168.988 58.5328 168.754L113.096 150.149C114.042 149.828 114.897 149.294 115.598 148.592L212.777 51.4102C220.572 43.6152 220.572 30.9338 212.777 23.1388L195.899 6.26078C192.125 2.48686 187.099 0.403992 181.762 0.403992C176.425 0.403992 171.399 2.48686 167.625 6.26078L70.4458 103.44C69.7423 104.143 69.2102 105.001 68.89 105.939L50.2846 160.505ZM63.652 155.386L108.562 140.074L205 43.633C208.504 40.126 208.504 34.423 205 30.916L188.122 14.038C184.723 10.642 178.804 10.642 175.405 14.038L78.964 110.476L63.652 155.386ZM80.7069 111.561L66.8582 152.18L107.477 138.331L203.585 42.2194C206.309 39.4933 206.309 35.0557 203.585 32.3296L186.708 15.4528C186.708 15.4526 186.709 15.453 186.708 15.4528C184.09 12.8379 179.437 12.8373 176.819 15.4522C176.819 15.4524 176.819 15.452 176.819 15.4522L80.7069 111.561Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M70.783 106.585L69.8365 106.262C70.1076 105.467 70.5582 104.742 71.1529 104.147L168.332 6.96789C171.918 3.38143 176.691 1.40399 181.762 1.40399C186.833 1.40399 191.606 3.38143 195.192 6.96789L212.07 23.8459C219.475 31.2504 219.475 43.2986 212.07 50.7031L114.891 147.885L114.184 147.178L211.363 49.996C218.377 42.982 218.377 31.567 211.363 24.553L194.485 7.67499C191.086 4.27599 186.568 2.40399 181.762 2.40399C176.956 2.40399 172.438 4.27599 169.039 7.67499L71.86 104.854C71.374 105.34 71.005 105.934 70.783 106.585ZM51.2308 160.828L69.8365 106.262L70.783 106.585L52.177 161.152C51.622 162.775 52.042 164.572 53.254 165.784C54.112 166.642 55.264 167.101 56.437 167.101C56.923 167.101 57.412 167.023 57.886 166.861L112.453 148.255C113.107 148.033 113.698 147.664 114.184 147.178L114.891 147.885C114.297 148.479 113.575 148.93 112.774 149.202L58.2094 167.807C57.6287 168.006 57.0303 168.101 56.437 168.101C55.0044 168.101 53.5964 167.541 52.5469 166.491C51.0662 165.01 50.5524 162.813 51.2308 160.828ZM63.652 155.386L108.562 140.074L205 43.633C208.504 40.126 208.504 34.423 205 30.916L188.122 14.038C184.723 10.642 178.804 10.642 175.405 14.038L78.964 110.476L63.652 155.386ZM79.8355 111.019L176.112 14.7454C179.12 11.7396 184.406 11.7395 187.415 14.7451C187.415 14.745 187.415 14.7452 187.415 14.7451L204.293 31.6228C207.406 34.7392 207.406 39.8093 204.293 42.9259C204.293 42.9258 204.293 42.926 204.293 42.9259L108.019 139.203L65.2551 153.783L79.8355 111.019Z" fill="#707070"/>
          <path d="M114.184 140.812L78.2233 104.851L71.8594 111.215L107.82 147.176L114.184 140.812Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M78.2233 102.023L117.012 140.812L107.82 150.004L69.031 111.215L78.2233 102.023ZM114.184 140.812L107.82 147.176L71.8594 111.215L78.2233 104.851L114.184 140.812Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M78.2233 103.437L115.598 140.812L107.82 148.59L70.4452 111.215L78.2233 103.437ZM114.184 140.812L107.82 147.176L71.8594 111.215L78.2233 104.851L114.184 140.812Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M78.2233 100.609L118.426 140.812L107.82 151.418L67.6168 111.215L78.2233 100.609ZM78.2233 103.437L115.598 140.812L107.82 148.59L70.4452 111.215L78.2233 103.437ZM71.8594 111.215L107.82 147.176L114.184 140.812L78.2233 104.851L71.8594 111.215ZM78.2233 107.68L74.6878 111.215L107.82 144.347L111.355 140.812L78.2233 107.68Z" fill="#707070"/>
          <path d="M203.26 51.7327L167.3 15.7724L160.936 22.1363L196.896 58.0966L203.26 51.7327Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M167.3 12.944L206.088 51.7327L196.896 60.925L158.107 22.1363L167.3 12.944ZM203.26 51.7327L196.896 58.0966L160.936 22.1363L167.3 15.7724L203.26 51.7327Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M167.3 14.3582L204.674 51.7327L196.896 59.5108L159.522 22.1363L167.3 14.3582ZM203.26 51.7327L196.896 58.0966L160.936 22.1363L167.3 15.7724L203.26 51.7327Z" fill="#707070"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M167.3 11.5298L207.503 51.7327L196.896 62.3392L156.693 22.1363L167.3 11.5298ZM167.3 14.3582L204.674 51.7327L196.896 59.5108L159.522 22.1363L167.3 14.3582ZM160.936 22.1363L196.896 58.0966L203.26 51.7327L167.3 15.7724L160.936 22.1363ZM167.3 18.6008L163.764 22.1363L196.896 55.2682L200.432 51.7327L167.3 18.6008Z" fill="#707070"/>
        </svg>
      </span>
    </div>
    <div>
      <p class="item-title">{{ item.title }}</p>
      <p class="item-description" v-if="item.description">{{ item.description }}</p>
    </div>
  </div>

</template>

<script>

export default {
  props: {
    item: Object
  },

  computed: {
    classes () {
      return {
        'is-due': this.isDue,
        'is-overdue': this.isOverdue,
      }
    },

    timestamp () {
      return Number(new Date(this.item.date))
    },

    isOverdue () {
      return this.timestamp && this.timestamp < Date.now()
    },

    isDue () {
      const date = this.timestamp
      const due = date - (1000 * 60 * 60 * 24) * 3
      const now = Date.now()
      return date > now && now > due
    },
  },

  methods: {
    edit () {
      this.$emit('edit', this.item)
    }
  }
}

</script>

<style lang="scss" scoped>
  .card {
    position: relative;
    border-radius: 3px;
    cursor: default;
    &:hover {
      background: #ffffffd9;
    }
  }

  .item-description {
    font-size: 0.7em;
  }

  .icons {
    position: absolute;
    bottom: 5px;
    right: 10px;
    cursor: pointer;
  }

  .is-overdue {
    color: red;
    border: 1px solid red;
  }

  .card:hover {
    .icon-due,
    .icon-date {
      display: none;
    }
  }

  .icon-edit,
  .icon-date {
    color: #DDD;
  }

  .icon-edit {
    display: none;
    margin-right: -5px;
    .card:hover & {
      display: block;
    }
    svg {
      width: 25px;
      height: 25px;
    }
  }
</style>
